@(user: User, watchingVideo: WatchingVideo, form: Form[Application.VideoEndedForm])

@main(user, "index") {
    <div class="jumbotron">
        <div class="container">
            <div class="span1"></div>
            <div class="well span8">
                @if(watchingVideo!=null) {
                    <video id="myVideo" autoplay controls preload="auto" width="320" height="240">
                        <source src="assets/uploads/@(watchingVideo.getVideo().getId()).webm" type='video/webm'>
                        <source src="assets/uploads/@(watchingVideo.getVideo().getId()).mp4" type='video/mp4'>
                        Your browser does not support the HTML5 video.
                    </video>
                    <h4>@watchingVideo.getVideo().getTitle()</h4>
                    <p>@watchingVideo.getVideo().getDescription()</p>
                    <form action="@routes.Application.readVideoEndedForm()" method="post" id="videoEndedForm">
                        <input type="hidden" name="videoId" value="@(watchingVideo.getVideo().getId())">
                        <button type="submit" id="videoEndedButton" class="btn btn-success" disabled>Next (Earn @(Video.centsToDollars(watchingVideo.getPayout()))) <i class="icon-play icon-white"></i></button>
                    </form>
                } else {
                    You have already watched all paying videos
                }
            </div>
            <div class="span3"></div>
        </div>
    </div>
    
    <script type="text/javascript">
        $(document).ready(function() {
            document.getElementById('myVideo').removeAttribute("controls");
        });
        document.getElementById('myVideo').addEventListener('ended', onEnded, false);
        function onEnded(e) {
            if(!e) {e = window.event;}
            document.getElementById("videoEndedButton").removeAttribute("disabled");
            //document.getElementById("myForm").submit();
        }
    </script>
}